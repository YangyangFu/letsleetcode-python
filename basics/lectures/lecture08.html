
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lecture 8: Binary Heap &#8212; Let&#39;s LeetCode in Python</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Lecture 9: Breadth-First Search" href="lecture09.html" />
    <link rel="prev" title="Lecture 7: Binary Trees - II" href="lecture07.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Let's LeetCode in Python</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   Introduction
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Basics
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../lectures.html">
   Lectures
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="lecture01.html">
     Lecture 1: Introduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="lecture02.html">
     Lecture 2: Data Structure and Dynamic Array
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="lecture03.html">
     Lecture 3: Set and Sorting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="lecture04.html">
     Hashing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="lecture05.html">
     Lecture 5: Linear Sorting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="lecture06.html">
     Lecture 6: Binary Trees - I
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="lecture07.html">
     Lecture 7: Binary Trees - II
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Lecture 8: Binary Heap
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="lecture09.html">
     Lecture 9: Breadth-First Search
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="lecture10.html">
     Lecture 10: Depth-First Search
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="lecture11.html">
     Lecture 11: Weighted Shortest Path
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="lecture12.html">
     Lecture 12: The Bellman-Ford Algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="lecture13.html">
     Lecture 13: The Dijkstra’s Algorithm
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../overview.html">
   Overview
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Convex-optimization
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../convex-optimization/interior-point-method.html">
   Interior-point Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../convex-optimization/newton-method.html">
   Newton Iterative Method
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Leetcode
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../leetcode/solutions.html">
   Solutions
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../leetcode/solutions/0001-two-sum.html">
     0001. Two Sum
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../leetcode/solutions/0003-longest-substring.html">
     0003. Longest Substring without Repeating Characters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../leetcode/solutions/0004-median-two-sorted-array.html">
     0004. Median of Two Sorted Arrays
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../leetcode/solutions/0005-longest-palindromic-string.html">
     0005. Longest Palindromic String
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../leetcode/solutions/0015-three-sum.html">
     0015. Three Sum
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../leetcode/solutions/0016-three-sum-closest.html">
     0016. Three Sum Closest
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../leetcode/solutions/0018-four-sum.html">
     0018. Four Sum
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../leetcode/solutions/0021-merge-two-sorted-lists.html">
     0021 Merge Two Sorted Lists
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../leetcode/solutions/0022-generate-parentheses.html">
     0022 Generate Parentheses
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../leetcode/solutions/0023-merge-k-sorted-list.html">
     0023 Merge k Sorted Lists
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../leetcode/solutions/0026-remove-duplicates.html">
     0026 Remove Duplicates
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../leetcode/solutions/0027-remove-element.html">
     0027 Remove Element
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../leetcode/solutions/0048-rotate-image.html">
     0048 Rotate Image
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../leetcode/solutions/0054-spiral-matrix.html">
     0054 Spiral Matrix
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../leetcode/solutions/0059-spiral-matrix-II.html">
     0059 Spiral Matrix II
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../leetcode/solutions/0076-minimum-window-substring.html">
     0076 Minimum Window Substring
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../leetcode/solutions/0083-remove-duplicates-linkedlist.html">
     0083 Remove Duplicates From Sorted List
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../leetcode/solutions/0086-partition-list.html">
     0086 Partition List
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../leetcode/solutions/0092-reversed-linked-list-II.html">
     0092. Reversed Linked List ii
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../leetcode/solutions/0160-intersection-of-two-linked-lists.html">
     0160 Intersection of Two Linked List
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../leetcode/solutions/0167-two-sum-ii.html">
     0167. Two Sum II
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../leetcode/solutions/0189-rotate-array.html">
     0189. Rotate Array
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../leetcode/solutions/0200-number-of-islands.html">
     0200. Number of islands
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../leetcode/solutions/0206-reversed-linked-list.html">
     0206. Reversed Linked List
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../leetcode/solutions/0303-range-sum-query.html">
     0303 Range Sum Query
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../leetcode/solutions/0304-range-sum-query-2D.html">
     0304 Range Sum Query - 2D
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../leetcode/solutions/0344-reverse-string.html">
     0344. Reverse String
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../leetcode/solutions/0370-range-addition.html">
     0370 Range Addition
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../leetcode/solutions/0438-all-anagrams.html">
     0438 Find All Anagrams in a String
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../leetcode/solutions/0463-island-perimeter.html">
     0463. Island Perimeter
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../leetcode/solutions/0567-permutation-in-string.html">
     0567 Minimum Window Substring
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../leetcode/solutions/0695-max-area-of-island.html">
     0695. Max Area of Island
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../leetcode/solutions/0704-binary-search.html">
     0704. Binary Search
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../leetcode/solutions/0733-flood-fill.html">
     0733. Flood Fill
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../leetcode/solutions/1109-flight-booking.html">
     1109 Flight Booking
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Notes
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../notes/algorithm.html">
   Algorithm
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../notes/algorithm/backtracking-algorithm.html">
     Backtracking
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../notes/algorithm/bigO.html">
     Big-O Complexity
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../notes/algorithm/dynamic-programming.html">
     Dynamic Programming
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../notes/algorithm/graph-algorithm.html">
     Graph algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../notes/algorithm/recursive-algorithms.html">
     Recursion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../notes/algorithm/search-algorithm.html">
     Search
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../notes/algorithm/sorting-algorithm.html">
     Sort
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../notes/data-structure.html">
   Data Structure
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../notes/data-structure/1-array.html">
     Array and String
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../notes/data-structure/2-linked-list.html">
     Singely Linked List
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../notes/data-structure/3-stack-and-queue.html">
     Stack
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../notes/data-structure/binary-search-tree.html">
     Binary Search Tree
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/basics/lectures/lecture08.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/YangyangFu/letsleetcode-python"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/YangyangFu/letsleetcode-python/issues/new?title=Issue%20on%20page%20%2Fbasics/lectures/lecture08.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#trees-in-arrays">
   Trees in Arrays
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#heaps">
   Heaps
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#priority-queue">
   Priority Queue
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Lecture 8: Binary Heap</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#trees-in-arrays">
   Trees in Arrays
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#heaps">
   Heaps
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#priority-queue">
   Priority Queue
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="lecture-8-binary-heap">
<h1>Lecture 8: Binary Heap<a class="headerlink" href="#lecture-8-binary-heap" title="Permalink to this headline">¶</a></h1>
<div class="section" id="trees-in-arrays">
<h2>Trees in Arrays<a class="headerlink" href="#trees-in-arrays" title="Permalink to this headline">¶</a></h2>
<p>The previous lectures store a binary tree with the help of pointer-liked structures, in which each item contains references to its children.
If the tree is a <code class="docutils literal notranslate"><span class="pre">complete</span> <span class="pre">binary</span> <span class="pre">tree</span></code>, there is a useful <code class="docutils literal notranslate"><span class="pre">array-based</span></code> alternative.</p>
<p><strong>Definition</strong>. A binary tree is complete if every level, except possibly the last, is completely filled, and all the leaves on the last level are placed as far to the left as possible.</p>
<p>A complete binary tree is one that can be obtained by filling the nodes starting with the root, and then each next level in turn, always from the left, until one runs out of nodes.
Complete binary trees always have minimal height for their size <span class="math notranslate nohighlight">\(n\)</span>, namely <span class="math notranslate nohighlight">\(logn\)</span>, and are always perfectly balanced.</p>
<p><img alt="One type of Complete Binary Tree: Max-heap" src="../../_images/l8-max-heap.png" /></p>
<ul class="simple">
<li><p>How to store in an array A?</p>
<ul>
<li><p>root is <span class="math notranslate nohighlight">\(A[0]\)</span></p></li>
<li><p>left(i) = <span class="math notranslate nohighlight">\(A[2i+1]\)</span></p></li>
<li><p>right(i) = <span class="math notranslate nohighlight">\(A[2i+2]\)</span></p></li>
<li><p>parent(i) = <span class="math notranslate nohighlight">\(A[floor(\frac{i-1}{2})]\)</span></p></li>
</ul>
</li>
<li><p>Storing a binary tree as an array is not efficient</p>
<ul>
<li><p>if the tree is not complete, reserve space in the array for every possible node in the tree</p></li>
<li><p>for binary search tree, insertion or deletion will involve shifting large portions of the array</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="heaps">
<h2>Heaps<a class="headerlink" href="#heaps" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>The (binary) heap data structure is an array object that we can view as a nearly complete binary tree.</p>
<ul>
<li><p>Each node of the tree corresponds to an element of the array.</p></li>
<li><p>The tree is completely filled on all levels except possibly the lowest, which is filled from the left up to a point</p></li>
<li><p>An array A that represents a heap is an object with two attributes: <code class="docutils literal notranslate"><span class="pre">A.length</span></code>, which (as usual) gives the number of elements in the array, and <code class="docutils literal notranslate"><span class="pre">A.heap-size</span></code>, which represents how many elements in the heap are stored within array <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p></li>
<li><p>Given the index <code class="docutils literal notranslate"><span class="pre">i</span></code>, we can easily calculate its parent, left and right child based on the way they are stored.</p></li>
</ul>
</li>
<li><p>Max-heap:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">max-heap</span> <span class="pre">property</span></code>: for every node <code class="docutils literal notranslate"><span class="pre">i</span></code> except the root, <span class="math notranslate nohighlight">\(A[parent(i)] &gt;= A[i]\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max-heap</span></code> is an array satisfying max-heap property at all nodes</p></li>
<li><p><strong>Min-heap</strong> is symmetric</p></li>
</ul>
</li>
<li><p>Heap operations</p>
<ul>
<li><p>the height of the tree is <span class="math notranslate nohighlight">\(floor(logn)\)</span>. The height for each node <span class="math notranslate nohighlight">\(i\)</span> is <span class="math notranslate nohighlight">\(floor(logn) - floor(log(i+1))\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_heapify_down(A,</span> <span class="pre">i)</span></code> -&gt; maintain the max-heap property of the <code class="docutils literal notranslate"><span class="pre">i</span></code>th node in heap <code class="docutils literal notranslate"><span class="pre">A</span></code> by swaping node with its larger child until max-heap property in <span class="math notranslate nohighlight">\(O(n)\)</span> time</p>
<ul>
<li><p>check whether <span class="math notranslate nohighlight">\(A[i] &gt;= A[j]\)</span> for <span class="math notranslate nohighlight">\(j \in {left(i), right(i)}\)</span></p></li>
<li><p>if not, swap <span class="math notranslate nohighlight">\(A[i]\)</span> with <span class="math notranslate nohighlight">\(A[j]\)</span> for child <span class="math notranslate nohighlight">\(j \in {left(i), right(i)}\)</span> with maximum value and recursively <code class="docutils literal notranslate"><span class="pre">max_heapify(A,</span> <span class="pre">j)</span></code>.</p></li>
<li><p>python implementation</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_heapify_up(A,</span> <span class="pre">i)</span></code> -&gt; maintain the max-heap property of the <code class="docutils literal notranslate"><span class="pre">i</span></code>th node in heap <code class="docutils literal notranslate"><span class="pre">A</span></code> by swaping node with its larger child until max-heap property in <span class="math notranslate nohighlight">\(O(n)\)</span> time</p>
<ul>
<li><p>check whether <span class="math notranslate nohighlight">\(A[i] &lt;= A[j]\)</span> for <span class="math notranslate nohighlight">\(j = parent(i)\)</span></p></li>
<li><p>if not, swap <span class="math notranslate nohighlight">\(A[i]\)</span> with <span class="math notranslate nohighlight">\(A[j]\)</span> and recursively <code class="docutils literal notranslate"><span class="pre">max_heapify_up(A,</span> <span class="pre">j)</span></code>.</p></li>
<li><p>python implementation</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">build(A)</span></code> -&gt; build a max-heap from array <span class="math notranslate nohighlight">\(A\)</span></p>
<ul>
<li><p>use <code class="docutils literal notranslate"><span class="pre">max-heapify</span></code> in a bottom-up manner to convert array <span class="math notranslate nohighlight">\(A\)</span> into a max-heap</p></li>
<li><p>iterate from <code class="docutils literal notranslate"><span class="pre">n/2</span></code> to <code class="docutils literal notranslate"><span class="pre">0</span></code></p>
<ul>
<li><p>the appendix array A[n/2:n] is at the bottom level (leafs) of a max-heap, and doesn’t need <code class="docutils literal notranslate"><span class="pre">max_heapify</span></code></p></li>
</ul>
</li>
<li><p>recursively use <code class="docutils literal notranslate"><span class="pre">max_heapify_down(A,</span> <span class="pre">i)</span></code></p></li>
<li><p>this build takes <span class="math notranslate nohighlight">\(O(n)\)</span> time</p></li>
<li><p>if build from a top-down manne using <code class="docutils literal notranslate"><span class="pre">max_heapify_up(A,i)</span></code>, the time complexity is <span class="math notranslate nohighlight">\(O(nlogn)\)</span> as the bottom of the tree (where most elements align) have to be <code class="docutils literal notranslate"><span class="pre">max_heapify</span></code> <span class="math notranslate nohighlight">\(logn\)</span> time for each node.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">delete_max(A)</span></code> -&gt; can only easily delete the last element in a dynamic array, but the max of a max_heap is at the root</p>
<ul>
<li><p>normally it requres <span class="math notranslate nohighlight">\(O(n)\)</span> time by removeing the first element in a dynamic array. can we do it in <span class="math notranslate nohighlight">\(logn\)</span> time?</p></li>
<li><p>algorithm</p>
<ul>
<li><p>swap the max at root node <span class="math notranslate nohighlight">\(i = 0\)</span> with the last item at node <span class="math notranslate nohighlight">\(n-1\)</span> in heap array, and then delete the last</p></li>
<li><p>update heap size by -1</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_heapify(A,</span> <span class="pre">0)</span></code> after swaping to maintain <code class="docutils literal notranslate"><span class="pre">max-heap</span> <span class="pre">property</span></code></p></li>
<li><p>return the deleted node</p></li>
</ul>
</li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">delete(i)</span></code></p>
<ul>
<li><p>can we simply use the <code class="docutils literal notranslate"><span class="pre">delete()</span></code> method for binary tree as illustrated in <a class="reference internal" href="lecture06.html"><span class="doc std std-doc">Lecture 6</span></a>? -&gt; not efficient, because the node <code class="docutils literal notranslate"><span class="pre">i</span></code> will mostly likely swapped to its predecessor or successor which is still inside the array.</p></li>
<li><p>dynamic array can easily remove the last element:</p>
<ul>
<li><p>swap <span class="math notranslate nohighlight">\(A[i]\)</span> with <span class="math notranslate nohighlight">\(A[n-1]\)</span></p></li>
<li><p>maintain the max-heap property of the heap <span class="math notranslate nohighlight">\(A[:n-1]\)</span> in <span class="math notranslate nohighlight">\(O(logn)\)</span></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>HEAPSORT: <code class="docutils literal notranslate"><span class="pre">heapsort(A)</span></code>:</p>
<ul>
<li><p>a in-place sorting algorithm that runs in <span class="math notranslate nohighlight">\(O(nlogn)\)</span>. note that <code class="docutils literal notranslate"><span class="pre">merge_sort</span></code> is also <span class="math notranslate nohighlight">\(O(nlogn)\)</span> but requires additional <span class="math notranslate nohighlight">\(O(n)\)</span> space.</p></li>
<li><p>algorithm</p>
<ul>
<li><p>for i in range(n, -1, 0)</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">delete_max(A)</span></code></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="priority-queue">
<h2>Priority Queue<a class="headerlink" href="#priority-queue" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>one of the most popular applications of a heap: as an efficient <code class="docutils literal notranslate"><span class="pre">priority</span> <span class="pre">queue</span></code></p>
<ul>
<li><p>a priority queue is a data structure for maintaining a set <code class="docutils literal notranslate"><span class="pre">S</span></code> of elements, each with an associated value called a key.</p></li>
<li><p>when we use a heap to implement a priority queue, therefore, we often need to store a handle (or key) to the corresponding application object in each heap element.
The exact makeup of the handle (such as a pointer or an integer) depends on the application.
Similarly, we need to store a handle to the corresponding heap element in each application object.</p></li>
<li><p>operations</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">get_max(A)</span></code> -&gt; get max of a max-heap A in <span class="math notranslate nohighlight">\(O(1)\)</span></p>
<ul>
<li><p>return <span class="math notranslate nohighlight">\(A[0]\)</span></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">delete_max(A)</span></code> -&gt; same as a max-heap</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">insert(A,</span> <span class="pre">k)</span></code> -&gt; insert an item with key <span class="math notranslate nohighlight">\(k\)</span> in the heap A ~ <span class="math notranslate nohighlight">\(O(logn)\)</span></p>
<ul>
<li><p>append the item with key <span class="math notranslate nohighlight">\(k\)</span> to the end of the heap: <span class="math notranslate nohighlight">\(A[n+1] = k\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_heapify_up(A,</span> <span class="pre">n+1)</span></code></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">delete_root()</span></code> -&gt; To use a binary heap tree as a priority queue, we will regularly need to delete the root, i.e. remove the node with the highest priority.</p>
<ul>
<li><p>this equals to <code class="docutils literal notranslate"><span class="pre">delete_max()</span></code></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">delete(A,</span> <span class="pre">k)</span></code> -&gt; delete an item with key <span class="math notranslate nohighlight">\(k\)</span> in the heap A ~ <span class="math notranslate nohighlight">\(O(logn)\)</span></p>
<ul>
<li><p>same as the <code class="docutils literal notranslate"><span class="pre">delete</span></code> method in a max_heap</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./basics/lectures"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="lecture07.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Lecture 7: Binary Trees - II</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="lecture09.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Lecture 9: Breadth-First Search</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Yangyang Fu<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>